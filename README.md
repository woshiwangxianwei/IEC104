# 104模拟主站

规约解析参考文档：配电自动化系统应用DL/T634.5104-2009实施细则

## 一、更新说明

| 版本号 | 版本日期   | 更新内容                                                     |
| :----- | :--------- | ------------------------------------------------------------ |
| v.001  | 2022-08-31 | 1.初版创建<br/>2.基础功能：增加总召按钮，IP、端口号、装置地址、主站地址输入框内修改<br/>3.增加报文显示窗口，显示终端和主站的通信报文<br/>4.增加连接状态显示，显示终端和主站的连接状态 |
| v.002  | 2022-09-01 | 1.增加清空报文按钮<br/>2.解析部分报文的类型和上送原          |
| v.003  | 2022-09-06 | 1.增加总召间隔时间输入框<br/>2.解析遥测、遥信点号和值<br/>3.增加遥测、遥信、遥控、遥调、电度表格窗口 |
| v.004  | 2022-09-15 | 1.表格窗口内显示突变或总召上送的遥测遥信电度信息<br/>2.增加电度冻结功能<br/>3.收发方报文信息区分颜色 |
| v.005  | 2022-09-16 | 1.增加复制报文、表格按钮<br/>2.增加报文自动滚屏复选框<br/>3.增加报文自动换行复选框<br/> |
| v.006  | 2022-09-19 | 1.增加信息提示窗口，显示提示信息<br/>2.修改界面布局<br/>3.增加报文窗口是否显示复选框 |
| v.007  | 2022-09-28 | 1.修改报文窗口解析地址时16进制输出<br/>2.增加界面右下角时钟<br/>3.增加报文自动换行按钮 |
| v.008  | 2022-10-01 | 1.增加复制报文或表格成功的提示框<br/>2.解析报文时增加遥测遥信的编号<br/>3.修复表格复制时存在的BUG<br/>4.增加表格窗口内遥信界面分合位颜色 |
| v.009  | 2022-10-03 | 1.修改单击单元格时可选中整行<br/>2.增加按钮图标<br/>3.增加时钟读取和对时功能\n" |
| v.010  | 2022-10-05 | 1.增加点击总召或者电度冻结时，可分别切换到表格的遥测和电度界面<br/>2.新增按钮区域的上下分割线 |
| v.011  | 2022-10-06 | 1.增加遥控功能，双击表格窗口遥控界面的单元格可进行单双点遥控操作<br/>2.修改表格窗口内的地址列为16进制<br/>3.增加点击按钮前先判断当前是否连接成功 |
| v.012  | 2022-10-07 | 1.修复遥控时不能遥控含字母的16进制点号的BUG<br/>2.增加遥控点号可自行设置数量的输入框，回车键生效<br/>3.修改对时和遥控窗口保持固定大小不可修改<br/>4.信息提示窗口内显示当前点号的遥控结果<br/>5.遥控窗口和对时窗口按ESC键可关闭窗口 |
| v.013  | 2022-10-08 | 1.修复对时时获取的时间年份大于99不能正常显示的BUG<br/>2.增加对时窗口内的时间差值<br/>3.增加表格窗口内数据类型和上送原因 |
| v.014  | 2022-10-09 | 1.增加建立链路成功后是否立即进行总召复选框<br/>2.增加关于窗口，用于显示版本迭代信息和开发过程 |
| v.015  | 2022-10-11 | 1.增加读取区号和参数定值功能<br/>2.解析上送的参数定值相关报文：点号、数据、类型、长度<br/>3.更改解析遥信数据时显示的数据格式由浮点型转为整型<br/>4.解析遥信报文数据时添加单双点信息<br/>5.切换表格不同界面显示独立功能：遥测遥信-总召、遥控-修改点号、遥调-读选区号，读定值、电度-召唤电度 |
| v.016  | 2022-10-12 | 1.修复读取区号后写区号时的BUG：最大最小区号相同时不显示区号<br/>2.解析参数定值到遥调表格内<br/>3.增加双击遥调表单元格可在弹窗内修改定值的功能<br/>4.主界面增加遥调按钮，默认点击就召唤定值区0的定值，并切换到遥调表界面 |
| v.017  | 2022-10-13 | 1.增加BUG反馈微信二维码<br/>2.修改遥调弹窗预置后才可固化<br/>3.预置定值时解析报文 |
| v.018  | 2022-10-14 | 1.遥调表内定值类型为bool时，用颜色区分投退                   |
| v.019  | 2022-11-09 | 1.修复固化定值时报文解析存在的错误<br/>2.定值类型为备用时禁用双击单元格设置定值功能<br/>3.设置定值数据为布尔型、无符号小整形、无符号短整型进行输入限制<br/>4.再次打开软件，默认IP为最后一次连接时使用的IP<br/>5.修复点击断开连接时报两次断开连接的bug |
| v.020  | 2023-01-03 | 1.增加10进制地址显示<br/>2.自组报文功能                      |
| v.021  | 2023-01-31 | 1.解析故障事件<br/>2.增加复位功能<br/>3.修改遥控预置和执行为独立按钮<br/>4.增加遥调自动测试功能 |
| v.022  | 2023-02-24 | 1.新增遥调界面的右键读取单个点功能<br/>2.解析八位位串格式的参数定值<br/>3.遥调自动测试预置间隔可设置 |
| v.023  | 2023-02-27 | 1.修复遥调自动测试时设置字符串类型的数据时存在的bug<br/>2.增加自动测试时设置float型数据的可变更项 |
| v.024  | 2023-03-01 | 1.修复设置字符串类型的数据时存在的bug<br/>2.修改表格表头     |
| v.025  | 2023-03-09 | 1.修改定值区号个数默认为0 1 2，便于适配青海地区的默认定值区号为1的要求<br/>2.修复预置定值时未读取定值区号，一直为0的bug |
| v.026  | 2023-03-14 | 1.对时时间可手动修改<br/>2.修改子窗口不再固定大小，改为自适应大小 |
| v.027  | 2023-03-24 | 1.增加遥调测试时设置float型定值的可选项<br/>2.遥控窗口默认置合<br/>3.时钟同步读取时解析星期几 |
| v.028  | 2023-04-03 | 1.增加遥控遥调撤销命令<br/>2.增加utf-8和GB2312编码的切换<br/>3.增加建立TCP连接后是否进行链路<br/>4.修改打开时间窗口可操作其他界面 |
| v.029  | 2023-04-10 | 1.增加文件上装功能                                           |
| v.030  | 2023-04-15 | 1.增加按配置读取点号功能<br/>2.增加清空表格功能<br/>3.增加报文框的滑动条移动可自动滚动功能<br />4.修改打开时间窗口时不可操作其他界面防止可能存在的问题 |
| v.031  | 2023-04-29 | 1.增加SOE窗口<br />2.增加故障事件窗口<br />3.修复预置遥调时未更新区号的问题 |
| v.032  | 2023-05-31 | 1.增加报文解析按钮打开外部解析工具<br />2.修复中间版本将时标电能量未解析的问题 |
| v.033  | 2023-06-20 | 1.修复数据类型为整型时，下发浮点型数值被置0的问题            |
| v.034  | 2023-07-08 | 1.增加切换定值区功能                                         |
| v.035  | 2023-08-19 | 1.增加点号名称<br />2.增加导出表格：区分固有参数、运行参数、动作参数<br />3.增加导入表格功能，可批量修改定值 |
| v.036  | 2023-08-31 | 1.扩展有符号数据类型                                         |
| v.037  | 2023-10-13 | 1.SOE以及故障事件点号的16进制数增加0x                        |
| v.038  | 2023-10-27 | 1.存储装置的公共地址到本地<br />2.增加Ping功能               |



## 二、界面介绍

### 2.1 主界面

![主界面](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027140340409.png)

### 2.2 链路区

![image-20231027142820831](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027142820831.png)

- 连接断开时：连接状态变为104未连接！
- 连接后链路：建立TCP连接后发起104连接。
- 链路后总召：建立链路后自动进行总召。
- 建立连接：输入服务器IP地址、端口号以及终端所配置的公共地址后点击**Connect**，连接过程中按钮状态为**Connecting...**连接成功后按钮内容变为**Disconnect**，右侧连接状态变为104已连接！

### 2.3 功能区

![image-20231027142836787](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027142836787.png)

#### 2.3.1 总召

- 点击后发起总召唤命令，并切换数据区的内容到遥测界面（若当前界面处于遥信区则不进行界面切换操作）。

#### 2.3.2 对时

![对时窗口](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027141101377.png)

- 点击后弹出对时窗，**读取时间**后会一直向服务器发起读取时间命令，停止读取后停止发送。**设置时间**时默认使用的电脑时间，若向手动设置就先勾选**手动修改**再进行设置时间。

#### 2.3.3 定值

- 点击后发送读取全定值命令，并切换到遥调界面，

#### 2.3.4 电度

- 点击后发送电能量召唤命令，并切换到电度界面

#### 2.3.5 遥控

- 点击后切换到遥控界面

#### 2.3.6 自组报文

![自组报文窗](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027141342393.png)

- 点击后弹出自组报文窗，可手动组报文并发送给服务器。点击**保存到文件**可将手组的报文保存到文件，便于下一次使用**启用文件数据源**进行使用。

#### 2.3.7 复位

- 点击后发送复位命令。类型：105（1字节）、信息对象地址：0（3字节）复位进程限定词QRP：1（1字节）。例如：
- 15:21:43.950  (主站—>终端) 016: 68 0e 08 00 34 00 69 01 06 00 03 00 00 00 00 01 

#### 2.3.8 登录

![image-20231027152635537](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027152635537.png)

- 点击后弹出登录窗，密码为6615，登录后可使用扩展功能。
- 扩展功能1：批量导出定值，导入修改定值。
- 扩展功能2：遥调自动测试。

#### 2.3.9 文件路径

![image-20231027153112820](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027153112820.png)

- 点击后在资源管理器中打开读取文件的所在路径。

#### 2.3.10  配置

![image-20231027153335293](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027153335293.png)

- 点击后显示如图菜单

1. 遥调配置:

   <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027141546185.png" alt="遥调点号配置" style="zoom:80%;" />

   - 点击后弹出遥调配置，可在窗口下方添加配置名后新增配置，根据需求手动添加点号，配合遥调界面的按配置读取，则仅读取配置的点号。
   - 恢复默认配置：会删除所有已配置的内容，小心使用。
   - 删除当前配置：会将当前使用配置删除。
   - 保存当前配置：顺序添加点号时会自动保存，若手动修改了单元格的点号，例如：手动将0x8020和0x8022之间的0x8021，修改为了0x8023，就需要点击一次保存当前配置，系统会自动对点号进行排序。

2. 名称设置

   <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027160535788.png" alt="名称设置" style="zoom: 80%;" />

   - 点击后会弹出一个txt文档，每行输入一个名称保存后关闭即可。配合**加载名称**使用。

#### 2.3.11 报文解析

调用同路径下的报文解析工具进行报文解析。

- 104报文解析

  <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027161100805.png" alt="104报文解析" style="zoom: 67%;" />

- 101报文解析

  <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027160855927.png" alt="101报文解析" style="zoom: 67%;" />

#### 2.3.12 导出定值

- 点击后可将定值导出到excel内，分位三个工作薄：固有参数、运行参数、动作参数。

  <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027174937827.png" alt="导出定值" style="zoom: 67%;" />

#### 2.3.13 导入定值

- 登录后可见

- 点击后可将选中的excel内的数据按照信息体地址下发设定值命令，但不会设置固有参数。

  <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027175151216.png" alt="导入定值" style="zoom:67%;" />

#### 2.3.14 PING测试

- 点击后调用cmd进行Ping测试，测试对象为IP框内的内容，5次后自动关闭。

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027165440264.png" alt="Ping测试" style="zoom: 67%;" />

#### 2.3.14 关于

- 点击后可查看更新记录

  <img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027175346445.png" alt="关于" style="zoom:80%;" />

### 2.4 数据区

#### 2.4.1 遥测

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027143404496.png" alt="遥测界面" style="zoom:67%;" />

- 总召间隔s：在连接前设置该值不为0时，则会周期性发送总召命令。
- 点号：上送点号信息体地址的10进制。
- 地址H：上送点号信息体地址的16进制。
- 计数：包含总召和突变上送的次数。
- 更新时刻：收到报文时的电脑时间。

#### 2.4.2 遥信

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027143413538.png" alt="遥信界面" style="zoom:67%;" />

- 总召间隔s：在连接前设置该值不为0时，则会周期性发送总召命令。
- 点号：上送点号信息体地址的10进制。
- 地址H：上送点号信息体地址的16进制。
- 计数：包含总召和突变上送的次数，仅计数**无时标**的遥信次数。
- 更新时刻：收到报文时的电脑时间。

#### 2.4.3 遥控

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231102155625361.png" alt="遥控界面" style="zoom: 67%;" />

- 默认地址从6001开始，修改遥控点数后可增加点号。
- 双击单元格可进行遥控操作：

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027180225652.png" alt="image-20231027180225652" style="zoom:80%;" />

- 填写好遥控行号、重复次数、重复间隔、以及遥控类型后，点击遥控测试可进行遥控重复测试功能。

#### 2.4.4 遥调

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027143432421.png" alt="image-20231027143432421" style="zoom:67%;" />

- 区号下拉栏默认范围0-2，默认区号是0，读取区号后按照回复的报文进行设置。
- 切换定值区需要先选择要切换到的定值区。
- 按配置读取：根据遥调配置界面内配置的点号召唤定值。
- 读取全定值：发送召唤全部定值命令。
- 双击单元格可进行定值设置。

![image-20231027141714164](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027141714164.png)

#### 2.4.5 电度

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027143439174.png" alt="image-20231027143439174" style="zoom:67%;" />

#### 2.4.6 文件

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027143443029.png" alt="image-20231027143443029" style="zoom:67%;" />

文件类型：故障录波文件、

### 2.5 报文框

<img src="D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027142026099.png" alt="image-20231027142026099" style="zoom:67%;" />

### 2.6 SOE和事件

![SOE窗口](D:\1wisdom_软件\104相关软件\IEC104主站_mine\readme.assets\image-20231027140456667.png)

- 勾选报文区上方的【SOE】后出现
- 右键可单独清除表格内容，点击清除报文后会同时清除表格。
- 双击故障事件单元格，可在txt内查看该条数据具体内容。

---

作者：wangxianwei

邮箱：woshiwangxianwei@qq.com
